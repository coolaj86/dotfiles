---
- hosts: all
  tasks:
     - group_by: key="{{ ansible_distribution }}"

- name: system
  hosts: all 

  roles:
    # - role: dotstrap.gnu-tools
      # tags: gnu-tools
    - # role: dotstrap.macos
      # tags: macos
    - role: dotstrap.xdg
      tags: xdg

  tasks:
    - name: package | setup
      file:
        path: "{{ caskroom_dir }}" 
        state: directory
        mode: 'u=rwx,g=rwx,o=r-x'
        become: yes
      when: caskroom_dir is defined
    
    - name: package
      package: "{{ item }}"
      with_items: "{{ packages }}"
      when: packages is defined
      
